{"version":3,"sources":["assets\\script\\lib\\Audio.js"],"names":["cc","Class","extends","Component","properties","bgVolume","deskVolume","bgAudioID","init","t","sys","localStorage","getItem","parseFloat","game","on","EVENT_HIDE","console","log","audioEngine","pauseAll","EVENT_SHOW","resumeAll","getUrl","url","raw","playBGM","audioUrl","stop","play","playSFX","sfxVolume","audioId","setSFXVolume","v","setItem","setBGMVolume","force","resume","pause","bgmVolume","setVolume"],"mappings":"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","file":"unknown","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        // foo: {\r\n        //    default: null,      // The default value will be used only when the component attaching\r\n        //                           to a node for the first time\r\n        //    url: cc.Texture2D,  // optional, default is typeof default\r\n        //    serializable: true, // optional, default is true\r\n        //    visible: true,      // optional, default is true\r\n        //    displayName: 'Foo', // optional\r\n        //    readonly: false,    // optional, default is false\r\n        // },\r\n        // ...\r\n        bgVolume:1.0,           // 背景音量\r\n\r\n        deskVolume:1.0,         //   房间 房间音量\r\n        \r\n        bgAudioID:-1            //   背景 音乐  id\r\n    },\r\n\r\n    // use this for initialization\r\n    init: function () {\r\n        var t = cc.sys.localStorage.getItem(\"bgVolume\");\r\n        if(t != null){\r\n            this.bgVolume = parseFloat(t);    \r\n        }\r\n        \r\n        var t = cc.sys.localStorage.getItem(\"deskVolume\");\r\n\r\n        if(t != null){\r\n            this. deskVolume = parseFloat(t);    \r\n        }\r\n        \r\n        cc.game.on(cc.game.EVENT_HIDE, function () {\r\n            console.log(\"cc.audioEngine.pauseAll\");\r\n            cc.audioEngine.pauseAll();\r\n        });\r\n        cc.game.on(cc.game.EVENT_SHOW, function () {\r\n            console.log(\"cc.audioEngine.resumeAll\");\r\n            cc.audioEngine.resumeAll();\r\n        });\r\n    },\r\n\r\n    // called every frame, uncomment this function to activate update callback\r\n    // update: function (dt) {\r\n\r\n    // },\r\n    \r\n    getUrl:function(url){\r\n        return cc.url.raw(\"resources/sounds/\" + url);\r\n    },\r\n    \r\n    playBGM(url){\r\n        var audioUrl = this.getUrl(url);\r\n        console.log(audioUrl);\r\n        if(this.bgAudioID >= 0){\r\n            cc.audioEngine.stop(this.bgAudioID);\r\n        }\r\n        this.bgAudioID = cc.audioEngine.play(audioUrl,true,this.bgVolume);\r\n    },\r\n    \r\n    playSFX(url){\r\n        var audioUrl = this.getUrl(url);\r\n        if(this.sfxVolume > 0){\r\n            var audioId = cc.audioEngine.play(audioUrl,false,this.deskVolume);    \r\n        }\r\n    },\r\n    \r\n    setSFXVolume:function(v){\r\n        if(this.sfxVolume != v){\r\n            cc.sys.localStorage.setItem(\"deskVolume\",v);\r\n            this.deskVolume = v;\r\n        }\r\n    },\r\n    \r\n    setBGMVolume:function(v,force){\r\n        if(this.bgAudioID >= 0){\r\n            if(v > 0){\r\n                cc.audioEngine.resume(this.bgAudioID);\r\n            }\r\n            else{\r\n                cc.audioEngine.pause(this.bgAudioID);\r\n            }\r\n        }\r\n        if(this.bgVolume != v || force){\r\n            cc.sys.localStorage.setItem(\"bgVolume\",v);\r\n            this.bgmVolume = v;\r\n            cc.audioEngine.setVolume(this.bgAudioID,v);\r\n        }\r\n    },\r\n    \r\n    pauseAll:function(){\r\n        cc.audioEngine.pauseAll();\r\n    },\r\n    \r\n    resumeAll:function(){\r\n        cc.audioEngine.resumeAll();\r\n    }\r\n});\r\n"]}